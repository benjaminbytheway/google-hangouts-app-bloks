define("app",[],function(){var e,r=function(e){var r,t={};for(r in e)if(e.hasOwnProperty(r))try{t[r]=JSON.parse(e[r])}catch(a){}return t},t=function(e){var r,t={};for(r in e)if(e.hasOwnProperty(r))try{t[r]=JSON.stringify(e[r])}catch(a){}return t},a={LOBBY:1,LOADING:2,PLAY:3,DETERMINE_WINNER:4,CONGRATULATIONS:5};return e=angular.module("app",[]),e.run(["$rootScope",function(e){e.me=gapi.hangout.getLocalParticipant(),e.state=r(gapi.hangout.data.getState())||{},e.state.game||(e.state.game={}),e.state.game.currentStage||(e.state.game.currentStage=a.LOBBY),e.state.players||(e.state.players=[]),gapi.hangout.data.onStateChanged.add(function(t){var a,n,o,i;a=r(t.state);for(n in a)o=a[n],i=t.metadata[n],n&&(console.log(n+" updated elsewhere"),console.log(o),console.log(i));e.state=a,e.$apply()}),e.$watch("state",function(r,a,n){gapi.hangout.data.submitDelta(t(e.state))},!0),e.computers=0,e.addPlayer=function(r){var t,a;if(a=e.state.players,r.player&&r.player.id&&a.length<4&&!e.findPlayerById(r.player.id)){if(t={},!r.player.type)throw new Error("config.player.type was not provided");if(t.type=r.player.type,"human"===t.type){if(!r.player.id)throw new Error("config.player.id was not provided");if(t.id=r.player.id,!r.player.name)throw new Error("config.player.name was not provided");t.name=r.player.name,r.player.image&&(t.image=r.player.image)}else{if("computer"!==t.type)throw new Error('config.player.type is not a supported type (either "human", or "computer")');t.id="computer-"+Math.floor(1e4*Math.random()),t.name="Computer "+e.computers+1}return a.push(t),e.state.host||"human"!==t.type||(e.state.host=t),!0}return!1},e.findPlayerById=function(r){var t,a,n,o;for(o=e.state.players,t=0,a=o.length;a>t;t++)if(n=o[t],n.id===r)return n;return null},e.join=function(){e.addPlayer({player:{type:"human",id:e.me.person.id,name:e.me.person.displayName,image:e.me.person.image.url}})}}]),e}),define("events",[],function(){var e={},r={};return{on:function(t,a,n){if(r[t]){if(!n)return;try{a(r[t])}catch(o){console.error(o)}}e[t]||(e[t]=[]),e[t].push(a)},off:function(r,t){var a;if(e[r]&&e[r].length)for(a=e[r].length-1;a>=0;a--)e[r][a]===t&&e[r][a].splice(a,1)},trigger:function(t,a){var n,o,i;if(r[t]=a,e[t]&&e[t].length)for(n=0,o=e[t].length;o>n;n++)if(i=e[t][n])try{i(a)}catch(p){console.error(p)}return!0}}}),define("player",["events"],function(){var e=function(e){var r=this;if(!e.type)throw new Error("config.type was not provided");if(r.type=e.type,"human"===r.type){if(!e.id)throw new Error("config.id was not provided");if(r.id=e.id,!e.name)throw new Error("config.name was not provided");r.name=e.name,e.image&&(r.image=e.image)}else if("computer"!==r.type)throw new Error('config.type is not a supported type (either "human", or "computer")')},r=e.prototype;return r.takeTurn=function(){},e}),define("game",["player","events"],function(e,r){var t;return t={initialize:function(e){var r=this;return e.game.host&&(r.host=e.game.host),e.game.players&&(r.players=e.game.players),e.game.currentStage&&(r.currentStage=e.game.currentStage),!0},players:[],addPlayer:function(t){var a,n=this;return t.player&&t.player.id&&n.players.length<4&&!n.findPlayerById(t.player.id)?(a=new e(t.player),n.players.push(a),n.host||n.setHost({player:a}),t.supressEvent||r.trigger("game.addPlayer",{game:n}),!0):!1},updatePlayers:function(e){var r,t,a,n,o,i,p,s=this;for(r=0,t=e.length;t>r;r++){for(p=!1,o=e[r],a=0,n=s.players.length;n>a;a++)i=s.players[a],o.id===i.id&&(p=!0);p||s.addPlayer({player:o,supressEvent:!0})}for(a=0,n=s.players.length;n>a;a++){for(p=!1,i=s.players[a],r=0,t=e.length;t>r;r++)o=e[r],o.id===i.id&&(p=!0);p||s.removePlayer({player:o,supressEvent:!0})}},removePlayer:function(e){var a,n,o=this;if(!e.player)return!1;for(e.player.id===o.host.id&&o.players.length>0&&o.setHost({player:o.players[0]}),n=o.players.length-1;n>=0;n--)if(o.players[n]===e.player)return a=o.players.splice(n,1),e.supressEvent||r.trigger("game.removePlayer",{game:t}),!0;return!1},findPlayerById:function(e){var r,t,a,n=this;for(r=0,t=n.players.length;t>r;r++)if(a=n.players[r],a.id===e)return a;return null},host:null,setHost:function(e){var t=this;return"human"===e.player.type?(t.host=e.player,e.supressEvent||r.trigger("game.setHost",{game:t}),!0):!1},STAGES:{LOBBY:1,LOADING:2,PLAY:3,DETERMINE_WINNER:4,CONGRATULATIONS:5},currentStage:0,startStage:function(e){var t=this;t.currentStage=e,t.currentStage===t.STAGES.LOBBY||t.currentStage===t.STAGES.LOADING,r.trigger("game.startStage",{game:t})},start:function(e){var r=this;e.currentStage===r.STAGES.LOBBY||e.currentStage===r.STAGES.LOADING}}}),define("ui",["events"],function(e){var r=document,t=r.getElementById("buttonJoin");return t.addEventListener("click",function(){}),e.on("ui.1.game.players.changed",function(e){}),{}}),define("controllers/game",["app","player","events"],function(e,r,t){e.controller("GameController",["$rootScope",function(e){}])}),require(["app","game","player","events","ui","controllers/game"],function(e,r,t,a,n){var o=new Promise(function(e,r){gapi.hangout.onApiReady.add(function(r){r.isApiReady&&e()})});o.then(function(){angular.bootstrap(document,["app"])}).then(function(){gapi.hangout.data.onStateChanged.add(function(e){}),gapi.hangout.onParticipantsDisabled.add(function(e){console.log("disabled");var t,a,n,o,i;for(t=0,a=e.disabledParticipants.length;a>t;t++)for(o=e.disabledParticipants[t],n=r.players.length-1;n>=0;n--)i=r.players[n],o.id===i.id&&r.removePlayer({player:i})})})}),define("main",function(){});