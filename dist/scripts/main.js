define("app",[],function(){var t,o=function(t){var o,e={};for(o in t)if(t.hasOwnProperty(o))try{e[o]=JSON.parse(t[o])}catch(a){}return e},e=function(t){var o,e={};for(o in t)if(t.hasOwnProperty(o))try{e[o]=JSON.stringify(t[o])}catch(a){}return e},a={LOBBY:1,CHOOSE_COLOR:2,PLAY:3,DETERMINE_WINNER:4,CONGRATULATIONS:5};return t=angular.module("app",[]),t.run(["$rootScope",function(t){function n(t){var o,e,a=t.length,n=t[0].length,r=0,i=0,s=[];for(e=0;n>e;e++){for(o=a-1;o>=0;o--)s[r]||(s[r]=[]),s[r][i]=t[o][e],i++;r++,i=0}return s}function r(t){var o,e,a=t.length,n=t[0].length,r=0,i=0,s=[];for(e=n-1;e>=0;e--){for(o=0;a>o;o++)s[r]||(s[r]=[]),s[r][i]=t[o][e],i++;r++,i=0}return s}function i(t){var o,e,a=t.length,n=t[0].length,r=0,i=0,s=[];for(o=a-1;o>=0;o--){for(e=0;n>e;e++)s[r]||(s[r]=[]),s[r][i]=t[o][e],i++;r++,i=0}return s}function s(t){var o,e,a=t.length,n=t[0].length,r=0,i=0,s=[];for(o=0;a>o;o++){for(e=n-1;e>=0;e--)s[r]||(s[r]=[]),s[r][i]=t[o][e],i++;r++,i=0}return s}function l(t,o,e){var a,n,r,i,s=t.userData.layout,l=s.length,u=s[0].length,c=!0,d=!0,p=!1,y=!1;for(a=0,n=l;n>a;a++){for(r=0,i=u;i>r;r++){if(_[o+a]&&_[o+a][e+r]||(c=!1),_[o+a]&&_[o+a][e+r]&&_[o+a][e+r].userData.block&&s[a][r]){d=!1;break}o+a!==0&&o+a!==19||e+r!==0&&e+r!==19||!s[a]||!s[a][r]||(y=!0),_[o+a]&&_[o+a][e+r]&&s[a]&&s[a][r]&&(_[o+a-1]&&_[o+a-1][e+r-1]&&_[o+a-1][e+r-1].userData.block&&_[o+a-1][e+r-1].userData.block.userData.colorAgent===t.userData.colorAgent||_[o+a+1]&&_[o+a+1][e+r-1]&&_[o+a+1][e+r-1].userData.block&&_[o+a+1][e+r-1].userData.block.userData.colorAgent===t.userData.colorAgent||_[o+a-1]&&_[o+a-1][e+r+1]&&_[o+a-1][e+r+1].userData.block&&_[o+a-1][e+r+1].userData.block.userData.colorAgent===t.userData.colorAgent||_[o+a+1]&&_[o+a+1][e+r+1]&&_[o+a+1][e+r+1].userData.block&&_[o+a+1][e+r+1].userData.block.userData.colorAgent===t.userData.colorAgent)&&(y=!0),_[o+a]&&_[o+a][e+r]&&s[a]&&s[a][r]&&(_[o+a-1]&&_[o+a-1][e+r]&&_[o+a-1][e+r].userData.block&&_[o+a-1][e+r].userData.block.userData.colorAgent===t.userData.colorAgent||_[o+a+1]&&_[o+a+1][e+r]&&_[o+a+1][e+r].userData.block&&_[o+a+1][e+r].userData.block.userData.colorAgent===t.userData.colorAgent||_[o+a]&&_[o+a][e+r-1]&&_[o+a][e+r-1].userData.block&&_[o+a][e+r-1].userData.block.userData.colorAgent===t.userData.colorAgent||_[o+a]&&_[o+a][e+r+1]&&_[o+a][e+r+1].userData.block&&_[o+a][e+r+1].userData.block.userData.colorAgent===t.userData.colorAgent)&&(p=!0)}if(!c||!d||p)break}return c&&d&&!p&&y}function u(t){var o,e,a,n;t.preventDefault(),z.x=t.clientX/ct*2-1,z.y=2*-(t.clientY/dt)+1,tt=null,ot=null,v.setFromCamera(z,h),K&&Q?v.ray.intersectPlane(C,H)&&(Q.position.copy(H.sub(x)),a=Q.userData.layout.length,n=Q.userData.layout[0].length,tt=Math.floor((H.x+ft*pt/2-a*pt/2+pt/2)/pt),ot=Math.floor((H.z+gt*yt/2-n*yt/2+yt/2)/yt),g.remove(U),_[tt]&&_[tt][ot]&&(X=_[tt][ot],l(Q,tt,ot)&&(U=Q.clone(),U.position.copy(X.position),U.position.x=U.position.x+a*pt/2-pt/2,U.position.z=U.position.z+n*yt/2-yt/2,U.position.y=U.position.y+Et/2,g.add(U)))):(e=v.intersectObjects(lt,!0),e.length>0?(o=e[0],Z=o.object.parent?o.object.parent:o.object,it.style.cursor="move"):(Z=null,it.style.cursor="auto"))}function c(t){var o,e;t.preventDefault(),v.setFromCamera(z,h),e=v.intersectObjects(lt,!0),e.length>0&&(o=e[0],k.enabled=!1,K=o.object,o.object.parent&&(Q=o.object.parent),v.ray.intersectPlane(C,H)&&x.copy(H).sub(Q.position)),it.style.cursor="move"}function d(t){var o,e,a,n,r,i;if(t.preventDefault(),k.enabled=!0,K&&Q)if(l(Q,tt,ot)){for(X=_[tt][ot],o=0,e=Q.userData.layout.length;e>o;o++)for(G=0,J=Q.userData.layout[o].length;J>G;G++)Q.userData.layout[o][G]&&(_[tt+o][ot+G].userData.block=Q);a=Q.userData.layout.length,n=Q.userData.layout[0].length,B=new TWEEN.Tween(Q.position).to({x:X.position.x+a*pt/2-pt/2,z:X.position.z+n*yt/2-yt/2,y:X.position.y+Et/2},200).easing(TWEEN.Easing.Bounce.Out).onComplete(function(){B=null}).start(),lt.splice(lt.indexOf(Q),1),K=null,Q=null,g.remove(U)}else Q.position.x>2.2&&Q.position.x<8&&Q.position.z<2.4&&Q.position.z>-2.4&&(Q.startPosition.x=Q.position.x,Q.startPosition.z=Q.position.z,Q.startRotation=Q.rotation),r=Q.startPosition,i=Q.startRotation,B=new TWEEN.Tween(Q.position).to({x:r.x,z:r.z,y:r.y},200).easing(TWEEN.Easing.Exponential.Out).onComplete(function(){B=null}).start(),new TWEEN.Tween(Q.rotation).to({y:i.y,z:i.z},200).easing(TWEEN.Easing.Exponential.Out).onComplete(function(){B=null}).start();Z&&(K=null,Q=null)}function p(t){var o,e,a;t.preventDefault(),Q&&!I&&(a=Q,37===t.keyCode||65===t.keyCode?(a.isRotated=!a.isRotated,a.userData.layout=n(a.userData.layout),e=a.rotation.y,I=new TWEEN.Tween(a.rotation).to({y:e+Math.PI/2},200).easing(TWEEN.Easing.Exponential.Out).onComplete(function(){I=null,a=null}).start()):38===t.keyCode||87===t.keyCode?(a.isRotated?a.userData.layout=s(a.userData.layout):a.userData.layout=i(a.userData.layout),o=a.rotation.z,I=new TWEEN.Tween(a.rotation).to({z:o+Math.PI},200).easing(TWEEN.Easing.Exponential.Out).onComplete(function(){I=null,a=null}).start()):39===t.keyCode||83===t.keyCode?(a.isRotated=!a.isRotated,a.userData.layout=r(a.userData.layout),e=a.rotation.y,I=new TWEEN.Tween(a.rotation).to({y:e-Math.PI/2},200).easing(TWEEN.Easing.Exponential.Out).onComplete(function(){I=null,a=null}).start()):(40===t.keyCode||68===t.keyCode)&&(a.isRotated?a.userData.layout=s(a.userData.layout):a.userData.layout=i(a.userData.layout),o=a.rotation.z,I=new TWEEN.Tween(a.rotation).to({z:o-Math.PI},200).easing(TWEEN.Easing.Exponential.Out).onComplete(function(){I=null,a=null}).start()))}function y(){k.update(),D.render(g,h)}function E(o){requestAnimationFrame(E),t&&t.state&&t.state.game&&t.state.game.currentStage&&t.state.game.currentStage===a.PLAY&&(TWEEN.update(o),y())}var f=!1;t.me=gapi.hangout.getLocalParticipant(),t.state=o(gapi.hangout.data.getState())||{},t.state.game||(t.state.game={}),t.state.game.currentStage||(t.state.game.currentStage=a.LOBBY),t.state.players||(t.state.players=[]),t.state.colors||(t.state.colors={}),gapi.hangout.data.onStateChanged.add(function(e){var a,n,r,i;a=o(e.state);for(n in a)r=a[n],i=e.metadata[n],"board"===n?t.syncBoardWithState():"blocks"===n&&t.syncBlocksWithState();f=!0,setTimeout(function(){f&&(f=!1)},0),t.state=a,window.state=a,t.$apply()}),t.$watch("state",function(o,a,n){f?f=!1:gapi.hangout.data.submitDelta(e(t.state)),window.state=t.state},!0),t.computers=0,t.addPlayer=function(o){var e,a;if(a=t.state.players,o.player&&o.player.id&&a.length<4&&!t.findPlayerById(o.player.id)){if(e={},!o.player.type)throw new Error("config.player.type was not provided");if(e.type=o.player.type,"human"===e.type){if(!o.player.id)throw new Error("config.player.id was not provided");if(e.id=o.player.id,!o.player.name)throw new Error("config.player.name was not provided");e.name=o.player.name,o.player.image&&(e.image=o.player.image)}else{if("computer"!==e.type)throw new Error('config.player.type is not a supported type (either "human", or "computer")');e.id="computer-"+Math.floor(1e4*Math.random()),e.name="Computer "+t.computers+1}return a.push(e),t.state.host||"human"!==e.type||(t.state.host=e),!0}return!1},t.findPlayerById=function(o){var e,a,n,r;for(r=t.state.players,e=0,a=r.length;a>e;e++)if(n=r[e],n.id===o)return n;return null},t.removePlayer=function(o){var e,a,n;if(n=t.state.players,!o.player)return!1;for(e=n.length-1;e>=0;e--)if(n[e]===o.player)return a=n.splice(e,1),!0;return!1},t.showLeaveModal=!1,t.leave=function(){var o,e,a,n,r=!1;if(n=t.state.players,t.state.host&&t.state.host.id===t.me.person.id&&(r=!0),r)for(t.state.host=null,o=0,e=n.length;e>o;o++)if(a=n[o],t.me.person.id!==a.id&&"human"===a.type){t.state.host=a;break}t.removePlayer({player:t.findPlayerById(t.me.person.id)})},gapi.hangout.onParticipantsDisabled.add(function(o){var e,a,n,r,i,s,l=!1,u=!1;if(s=t.state.players,t.state.host)for(e=0,a=o.disabledParticipants.length;a>e;e++)if(r=o.disabledParticipants[e],r.person.id===t.state.host.id){l=!0;break}if(l)for(e=0,a=s.length;a>e;e++)if(i=s[e],t.me.person.id===i.id&&"human"===i.type&&t.state.host.id!==i.id){t.state.host=i;break}if(t.state.host&&t.state.host.id===t.me.person.id&&(u=!0),u)for(e=0,a=o.disabledParticipants.length;a>e;e++)for(r=o.disabledParticipants[e],n=s.length-1;n>=0;n--)if(i=s[n],r.person.id===i.id){t.removePlayer({player:i});break}t.$apply()}),t.join=function(){t.addPlayer({player:{type:"human",id:t.me.person.id,name:t.me.person.displayName,image:t.me.person.image.url}})},t.begin=function(){t.state.game.currentStage=a.CHOOSE_COLOR},t.isPlayer=function(){var o,e,a,n;for(e=t.state.players,a=0,n=e.length;n>a;a++)if(o=e[a],t.me.person.id===o.id)return!0;return!1},t.chooseColor=function(o){var e,a,n,r,i,s,l,u={blue:"Blue",red:"Red",green:"Green",yellow:"Yellow"},c={blue:255,green:65280,yellow:16776960,red:16711680};if(a=t.state.colors,e=t.state.players,t.myRemainingColors()&&!a[o]&&(a[o]={color:o,type:1,id:t.me.person.id,label:u[o],hex:c[o]}),3===e.length&&3===Object.keys(a).length){for(o in u)if(!a[o])break;for(i=[],s=0,l=e.length;l>s;s++){r=e[s];do n=Math.floor(3*Math.random());while(i[n]);i[n]=r.id}a[o]={color:o,type:2,id:i[0],order:i,current:0,label:u[o],hex:c[o]}}},t.myRemainingColors=function(){var o,e,a,n,r=0;if(a=t.state.colors,n=t.state.players,t.isPlayer()){2===n.length?r=2:(3===n.length||4===n.length)&&(r=1);for(e in a)o=a[e],1===o.type&&t.me.person.id===o.id&&r--}return r},t.getMyColors=function(){var o,e,a,n=[];a=t.state.colors;for(e in a)o=a[e],1===o.type&&t.me.person.id===o.id&&n.push(o);return n},t.getSharedColor=function(){var o,e,a,n;if(n=t.state.players,3===n.length){a=t.state.colors;for(e in a)if(o=a[e],2===o.type)return o}return null},t.displayColors=function(){var o="",e=t.getMyColors(!0);return e[0]&&e[0].label&&(o=e[0].label,e[1]&&e[1].label&&(o+=" and "+e[1].label)),o},t.displayChoosenColors=function(){return Object.keys(t.state.colors)},t.displaySharedColor=function(){var o=t.getSharedColor();return o&&o.label?o.label:!1},t.start=function(){t.state.game.currentStage=a.PLAY},t.state.board||(t.state.board={}),t.state.blocks||(t.state.blocks=[]);var g,h,m,w,P,D,R,T,b,v,C,x,H,z,k,S,A,O,V,M,q,L,N,W,I,B,j,Y,G,J,F,$,_,U,X,Z,K,Q,tt,ot,et,at,nt=window,rt=document,it=rt.getElementById("canvas-container"),st=new THREE.JSONLoader,lt=[],ut=[{id:21,startPosition:new THREE.Vector3(2.2,.1,1.5),squareCount:5,layout:[[1,1,1,1,1]]},{id:20,startPosition:new THREE.Vector3(2.6,.1,1.5),squareCount:5,layout:[[1,1,1,1],[1,0,0,0]]},{id:19,startPosition:new THREE.Vector3(3.1,.1,1.5),squareCount:5,layout:[[1,1,1,1],[0,1,0,0]]},{id:18,startPosition:new THREE.Vector3(3.6,.1,1.5),squareCount:5,layout:[[0,1,1,1],[1,1,0,0]]},{id:17,startPosition:new THREE.Vector3(2.4,.1,.6),squareCount:5,layout:[[1,1,1],[1,0,0],[1,0,0]]},{id:16,startPosition:new THREE.Vector3(3.1,.1,.6),squareCount:5,layout:[[0,1,1],[1,1,0],[1,0,0]]},{id:15,startPosition:new THREE.Vector3(3.8,.1,.6),squareCount:5,layout:[[0,1,1],[0,1,0],[1,1,0]]},{id:14,startPosition:new THREE.Vector3(2.4,.1,-.1),squareCount:5,layout:[[1,1,1],[0,1,0],[0,1,0]]},{id:13,startPosition:new THREE.Vector3(3.1,.1,-.1),squareCount:5,layout:[[0,1,1],[1,1,0],[0,1,0]]},{id:12,startPosition:new THREE.Vector3(3.8,.1,-.1),squareCount:5,layout:[[0,1,0],[1,1,1],[0,1,0]]},{id:11,startPosition:new THREE.Vector3(4.1,.1,1.5),squareCount:5,layout:[[1,1,1],[1,1,0]]},{id:10,startPosition:new THREE.Vector3(4.4,.1,.6),squareCount:5,layout:[[1,1,1],[1,0,1]]},{id:9,startPosition:new THREE.Vector3(2.2,.1,-.9),squareCount:4,layout:[[1,1,1,1]]},{id:8,startPosition:new THREE.Vector3(2.6,.1,-.9),squareCount:4,layout:[[1,1,1],[1,0,0]]},{id:7,startPosition:new THREE.Vector3(3.1,.1,-.9),squareCount:4,layout:[[1,1,1],[0,1,0]]},{id:6,startPosition:new THREE.Vector3(3.6,.1,-.9),squareCount:4,layout:[[1,1,0],[0,1,1]]},{id:5,startPosition:new THREE.Vector3(4.1,.1,-.9),squareCount:4,layout:[[1,1],[1,1]]},{id:4,startPosition:new THREE.Vector3(2.2,.1,-1.7),squareCount:3,layout:[[1,1,1]]},{id:3,startPosition:new THREE.Vector3(2.6,.1,-1.7),squareCount:3,layout:[[1,1],[1,0]]},{id:2,startPosition:new THREE.Vector3(3,.1,-1.7),squareCount:2,layout:[[1,1]]},{id:1,startPosition:new THREE.Vector3(3.3,.1,-1.7),squareCount:1,layout:[[1]]}],ct=it.offsetWidth,dt=it.offsetHeight,pt=.2,yt=.2,Et=.04,ft=20,gt=20,ht=.6;for(D=new THREE.WebGLRenderer,D.setSize(ct,dt),D.setClearColor(16777215),D.shadowMap.enabled=!0,g=new THREE.Scene,h=new THREE.PerspectiveCamera(45,ct/dt,.1,1e3),h.position.x=6,h.position.y=6,h.position.z=6,h.rotation.x=0,h.rotation.y=0,h.rotation.z=0,h.lookAt(new THREE.Vector3(0,0,0)),m=rt.getElementById("view-1"),w=rt.getElementById("view-2"),P=rt.getElementById("view-3"),m.addEventListener("click",function(t){h.position.x=0,h.position.y=10,h.position.z=0,h.rotation.x=0,h.rotation.y=0,h.rotation.z=0,h.lookAt(new THREE.Vector3(0,0,0))}),w.addEventListener("click",function(t){h.position.x=0,h.position.y=6,h.position.z=9,h.rotation.x=0,h.rotation.y=0,h.rotation.z=0,h.lookAt(new THREE.Vector3(0,0,0))}),P.addEventListener("click",function(t){h.position.x=6,h.position.y=6,h.position.z=6,h.rotation.x=0,h.rotation.y=0,h.rotation.z=0,h.lookAt(new THREE.Vector3(0,0,0))}),nt.addEventListener("resize",function(){ct=it.offsetWidth,dt=it.offsetHeight,h.aspect=ct/dt,h.updateProjectionMatrix(),D.setSize(ct,dt)},!1),k=new THREE.TrackballControls(h),k.rotateSpeed=1,k.zoomSpeed=1.2,k.panSpeed=.3,k.noZoom=!1,k.noPan=!1,k.noRotate=!1,k.staticMoving=!1,k.dynamicDampingFactor=.3,R=[],T=0,R[T]=new THREE.DirectionalLight(16777215,.25),R[T].position.x=-50,R[T].position.y=50,R[T].position.z=-50,R[T].castShadow=!0,g.add(R[T]),T=1,R[T]=new THREE.DirectionalLight(16777215,.25),R[T].position.x=50,R[T].position.y=50,R[T].position.z=50,R[T].castShadow=!0,g.add(R[T]),T=2,R[T]=new THREE.DirectionalLight(16777215,.25),R[T].position.x=-50,R[T].position.y=50,R[T].position.z=50,R[T].castShadow=!0,g.add(R[T]),T=3,R[T]=new THREE.DirectionalLight(16777215,.25),R[T].position.x=50,R[T].position.y=50,R[T].position.z=-50,R[T].castShadow=!0,g.add(R[T]),T=4,R[T]=new THREE.DirectionalLight(16777215,.25),R[T].position.x=0,R[T].position.y=-50,R[T].position.z=0,R[T].castShadow=!0,g.add(R[T]),b=new THREE.AmbientLight(5263440),g.add(b),_=[],A=st.parse({metadata:{},scale:1,materials:[],vertices:[-.1,0,.1,-.1,.01,.1,-.1,0,-.1,-.1,.01,-.1,.1,0,.1,.1,.01,.1,.1,0,-.1,.1,.01,-.1,.0975,.01,.0975,-.0975,.01,.0975,.0975,.01,-.0975,-.0975,.01,-.0975,.095,0,.095,-.095,0,.095,.095,0,-.095,-.095,0,-.095],morphTargets:[],morphColors:[],normals:[-1,0,0,0,0,-1,1,0,0,0,0,1,0,-1,0,0,1,0,-.9701,.2425,0,0,.2425,.9701,0,.2425,-.9701,.9701,.2425,0],colors:[],uvs:[[]],faces:[35,1,3,2,0,0,0,0,0,0,35,3,7,6,2,0,1,1,1,1,35,7,5,4,6,0,2,2,2,2,35,5,1,0,4,0,3,3,3,3,35,0,2,6,4,0,4,4,4,4,35,9,11,3,1,0,5,5,5,5,35,5,8,9,1,0,5,5,5,5,35,5,7,10,8,0,5,5,5,5,35,8,10,14,12,0,6,6,6,6,35,10,7,3,11,0,5,5,5,5,35,12,14,15,13,0,5,5,5,5,35,10,11,15,14,0,7,7,7,7,35,9,8,12,13,0,8,8,8,8,35,11,9,13,15,0,9,9,9,9]}).geometry,j=0,Y=ft;Y>j;j++)for(_[j]=[],G=0,J=gt;J>G;G++)O=new THREE.MeshPhongMaterial({color:16579836,shininess:50,side:THREE.DoubleSide}),S=new THREE.Mesh(A,O),S.position.x=j*pt-ft*pt/2+pt/2,S.position.z=G*yt-gt*yt/2+yt/2,S.castShadow=!0,S.receiveShadow=!1,S.userData.xIndex=j,S.userData.zIndex=G,S.userData.block=null,S.userData.square=null,_[j][G]=S,g.add(S);V=new THREE.BoxGeometry(ft*pt,ht,gt*yt),M=new THREE.MeshPhongMaterial({color:16579836,shininess:50,side:THREE.DoubleSide}),q=new THREE.Mesh(V,M),q.position.y=-(ht/2)-1e-4,g.add(q);var mt,wt,Pt,Dt,Rt,Tt;for(et in t.state.colors)for(at=t.state.colors[et],F=0,$=ut.length;$>F;F++){for(wt=ut[F],mt=new THREE.Group,mt.userData.id=et+"-"+ut.id,mt.userData.layout=JSON.parse(JSON.stringify(wt.layout)),mt.userData.squareCount=wt.squareCount,mt.userData.colorAgent=at,mt.userData.color=et,Pt=mt.userData.layout.length,Dt=mt.userData.layout[0].length,j=0,Y=wt.layout.length;Y>j;j++)for(Rt=wt.layout[j],G=0,J=Rt.length;J>G;G++)Tt=Rt[G],Tt&&(N=st.parse({metadata:{},scale:1,materials:[],vertices:[.1,.01,-.1,-.1,.01,.1,.1,.01,.1,-.1,.01,-.1,-.1,.03,.1,.1,.03,.1,-.1,.03,-.1,.1,.03,-.1,-.0925,.03,.0925,-.0925,.03,-.0925,.0925,.03,.0925,.0925,.03,-.0925,-.0925,.04,.0925,-.0925,.04,-.0925,.0925,.04,.0925,.0925,.04,-.0925,-.0925,.01,.0925,.0925,.01,.0925,-.0925,.01,-.0925,.0925,.01,-.0925,-.0925,0,.0925,.0925,0,.0925,-.0925,0,-.0925,.0925,0,-.0925,-.065,.04,.065,-.065,.04,-.065,.065,.04,.065,.065,.04,-.065,-.065,.03,.065,-.065,.03,-.065,.065,.03,.065,.065,.03,-.065,-.065,0,.065,.065,0,.065,-.065,0,-.065,.065,0,-.065,-.065,.01,.065,.065,.01,.065,-.065,.01,-.065,.065,.01,-.065],morphTargets:[],morphColors:[],normals:[0,0,-1,0,0,1,1,0,0,-1,0,0,0,1,0,0,-1,0],colors:[],uvs:[[]],faces:[35,0,3,6,7,0,0,0,0,0,35,1,2,5,4,0,1,1,1,1,35,2,0,7,5,0,2,2,2,2,35,3,1,4,6,0,3,3,3,3,35,9,11,7,6,0,4,4,4,4,35,4,8,9,6,0,4,4,4,4,35,4,5,10,8,0,4,4,4,4,35,11,9,13,15,0,0,0,0,0,35,10,5,7,11,0,4,4,4,4,35,10,11,15,14,0,2,2,2,2,35,9,8,12,13,0,3,3,3,3,35,8,10,14,12,0,1,1,1,1,35,17,19,0,2,0,5,5,5,5,35,1,16,17,2,0,5,5,5,5,35,1,3,18,16,0,5,5,5,5,35,17,16,20,21,0,1,1,1,1,35,18,3,0,19,0,5,5,5,5,35,16,18,22,20,0,3,3,3,3,35,19,17,21,23,0,2,2,2,2,35,18,19,23,22,0,0,0,0,0,35,25,27,15,13,0,4,4,4,4,35,12,24,25,13,0,4,4,4,4,35,12,14,26,24,0,4,4,4,4,35,24,26,30,28,0,0,0,0,0,35,26,14,15,27,0,4,4,4,4,35,28,30,31,29,0,4,4,4,4,35,26,27,31,30,0,3,3,3,3,35,27,25,29,31,0,1,1,1,1,35,25,24,28,29,0,2,2,2,2,35,33,35,23,21,0,5,5,5,5,35,20,32,33,21,0,5,5,5,5,35,20,22,34,32,0,5,5,5,5,35,33,32,36,37,0,0,0,0,0,35,34,22,23,35,0,5,5,5,5,35,36,38,39,37,0,5,5,5,5,35,32,34,38,36,0,2,2,2,2,35,34,35,39,38,0,1,1,1,1,35,35,33,37,39,0,3,3,3,3]}).geometry,W=new THREE.MeshPhongMaterial({color:mt.userData.colorAgent.hex,transparent:!0,opacity:.75,shininess:75,side:THREE.DoubleSide}),L=new THREE.Mesh(N,W),L.position.x=j*pt-Pt*pt/2+pt/2,L.position.z=G*yt-Dt*yt/2+yt/2,L.position.y=-Et/2,L.userData.xIndex=j,L.userData.zIndex=G,mt.add(L));mt.startPosition=new THREE.Vector3,mt.startRotation=new THREE.Vector3,mt.isRotated=!1,"blue"===et?(mt.startPosition.x=wt.startPosition.x,mt.startPosition.y=wt.startPosition.y,mt.startPosition.z=wt.startPosition.z,mt.startRotation.y=0):"green"===et?(mt.startPosition.x=-wt.startPosition.x,mt.startPosition.y=wt.startPosition.y,mt.startPosition.z=-wt.startPosition.z,mt.startRotation.y=Math.PI,mt.userData.layout=n(n(mt.userData.layout))):"red"===et?(mt.startPosition.x=-wt.startPosition.z,mt.startPosition.y=wt.startPosition.y,mt.startPosition.z=wt.startPosition.x,mt.startRotation.y=Math.PI+Math.PI/2,mt.userData.layout=r(mt.userData.layout),mt.isRotated=!0):"yellow"===et&&(mt.startPosition.x=wt.startPosition.z,mt.startPosition.y=wt.startPosition.y,mt.startPosition.z=-wt.startPosition.x,mt.startRotation.y=Math.PI/2,mt.userData.layout=n(mt.userData.layout),mt.isRotated=!0),mt.position.x=mt.startPosition.x,mt.position.y=mt.startPosition.y,mt.position.z=mt.startPosition.z,mt.rotation.y=mt.startRotation.y,mt.castShadow=!0,mt.receiveShadow=!1,lt.push(mt),g.add(mt),t.state.blocks.push({id:et+"-"+ut.id,layout:mt.userData.layout,startPosition:{x:mt.startPosition.x,y:mt.startPosition.y,z:mt.startPosition.z},startRotation:{x:mt.startRotation.x,y:mt.startRotation.y,z:mt.startRotation.z},position:{x:mt.position.x,y:mt.position.y,z:mt.position.z},rotation:{x:mt.rotation.x,y:mt.rotation.y,z:mt.rotation.z},isRotated:mt.isRotated})}v=new THREE.Raycaster,z=new THREE.Vector2,C=new THREE.Plane(new THREE.Vector3(0,1,0)),x=new THREE.Vector3,H=new THREE.Vector3,D.domElement.addEventListener("mousemove",u,!1),D.domElement.addEventListener("mousedown",c,!1),D.domElement.addEventListener("mouseup",d,!1),document.addEventListener("keydown",p,!1),it.appendChild(D.domElement),E(),t.syncBoardWithState=function(){},t.syncBlocksWithState=function(){}}]),t}),define("events",[],function(){var t={},o={};return{on:function(e,a,n){if(o[e]){if(!n)return;try{a(o[e])}catch(r){console.error(r)}}t[e]||(t[e]=[]),t[e].push(a)},off:function(o,e){var a;if(t[o]&&t[o].length)for(a=t[o].length-1;a>=0;a--)t[o][a]===e&&t[o][a].splice(a,1)},trigger:function(e,a){var n,r,i;if(o[e]=a,t[e]&&t[e].length)for(n=0,r=t[e].length;r>n;n++)if(i=t[e][n])try{i(a)}catch(s){console.error(s)}return!0}}}),require(["app","events"],function(t,o){var e=new Promise(function(t,o){gapi.hangout.onApiReady.add(function(o){o.isApiReady&&t()})});e.then(function(){angular.bootstrap(document,["app"])})}),define("main",function(){});