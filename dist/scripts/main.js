define("events",[],function(){var e={},a={};return{on:function(t,r,n){if(a[t]){if(!n)return;try{r(a[t])}catch(i){console.error(i)}}e[t]||(e[t]=[]),e[t].push(r)},off:function(a,t){var r;if(e[a]&&e[a].length)for(r=e[a].length-1;r>=0;r--)e[a][r]===t&&e[a][r].splice(r,1)},trigger:function(t,r){var n,i,o;if(a[t]=r,e[t]&&e[t].length)for(n=0,i=e[t].length;i>n;n++)if(o=e[t][n])try{o(r)}catch(s){console.error(s)}return!0}}}),define("player",["events"],function(){var e=function(e){var a=this;if(!e.type)throw new Error("config.type was not provided");if(a.type=e.type,"human"===a.type){if(!e.id)throw new Error("config.id was not provided");if(a.id=e.id,!e.name)throw new Error("config.name was not provided");a.name=e.name,e.image&&(a.image=e.image)}else if("computer"!==a.type)throw new Error('config.type is not a supported type (either "human", or "computer")')},a=e.prototype;return a.takeTurn=function(){},e}),define("game",["player","events"],function(e,a){var t;return t={initialize:function(e){var a=this;return e.game.host&&(a.host=e.game.host),e.game.players&&(a.players=e.game.players),e.game.currentStage&&(a.currentStage=e.game.currentStage),!0},players:[],addPlayer:function(t){var r,n=this;return t.player&&t.player.id&&n.players.length<4&&!n.findPlayerById(t.player.id)?(r=new e(t.player),n.players.push(r),n.host||n.setHost({player:r}),t.supressEvent||a.trigger("game.addPlayer",{game:n}),!0):!1},updatePlayers:function(e){var a,t,r,n,i,o,s,g=this;for(a=0,t=e.length;t>a;a++){for(s=!1,i=e[a],r=0,n=g.players.length;n>r;r++)o=g.players[r],i.id===o.id&&(s=!0);s||g.addPlayer({player:i,supressEvent:!0})}for(r=0,n=g.players.length;n>r;r++){for(s=!1,o=g.players[r],a=0,t=e.length;t>a;a++)i=e[a],i.id===o.id&&(s=!0);s||g.removePlayer({player:i,supressEvent:!0})}},removePlayer:function(e){var r,n,i=this;if(!e.player)return!1;for(e.player.id===i.host.id&&i.players.length>0&&i.setHost({player:i.players[0]}),n=i.players.length-1;n>=0;n--)if(i.players[n]===e.player)return r=i.players.splice(n,1),e.supressEvent||a.trigger("game.removePlayer",{game:t}),!0;return!1},findPlayerById:function(e){var a,t,r,n=this;for(a=0,t=n.players.length;t>a;a++)if(r=n.players[a],r.id===e)return r;return null},host:null,setHost:function(e){var t=this;return"human"===e.player.type?(t.host=e.player,e.supressEvent||a.trigger("game.setHost",{game:t}),!0):!1},STAGES:{LOBBY:1,LOADING:2,PLAY:3,DETERMINE_WINNER:4,CONGRATULATIONS:5},currentStage:0,startStage:function(e){var t=this;t.currentStage=e,t.currentStage===t.STAGES.LOBBY||t.currentStage===t.STAGES.LOADING,a.trigger("game.startStage",{game:t})},start:function(e){var a=this;e.currentStage===a.STAGES.LOBBY||e.currentStage===a.STAGES.LOADING}}}),define("ui",["events"],function(e){var a=document,t=a.getElementById("buttonJoin");return t.addEventListener("click",function(){}),e.on("ui.1.game.players.changed",function(e){}),{}}),define("app",["game","player","events","ui"],function(e,a,t,r){var n;return n=angular.module("app",[]),n.run(["$rootScope",function(a){a.game=e,a.join=function(){t.trigger("ui.1.button.join.click")},t.on("ui.1.game.players.changed",function(e){a.$apply()})}]),n}),define("controllers/game",["app","player","events"],function(e,a,t){e.controller("GameController",["$rootScope",function(e){}])}),require(["app","game","player","events","ui","controllers/game"],function(e,a,t,r,n){var i,o,s=new Promise(function(e,a){gapi.hangout.onApiReady.add(function(a){a.isApiReady&&e()})}),g=function(e){var a,t={};for(a in e)if(e.hasOwnProperty(a))try{t[a]=JSON.parse(e[a])}catch(r){}return t},l=function(e){var a,t={};for(a in e)if(e.hasOwnProperty(a))try{t[a]=JSON.stringify(e[a])}catch(r){}return t},u=function(){i.writerId=o.id,gapi.hangout.data.submitDelta(l(i))};s.then(function(){angular.bootstrap(document,["app"]),o=gapi.hangout.getLocalParticipant(),i=g(gapi.hangout.data.getState()),i.game?a.initialize({game:i.game}):(i.game={currentStage:a.STAGES.LOBBY},u(),a.initialize({game:i.game}))}).then(function(){gapi.hangout.data.onStateChanged.add(function(e){i=g(e.state),i.writerId!==o.id&&("game.addPlayer"===i.eventName&&(a.updatePlayers(i.game.players),r.trigger("ui.1.game.players.changed",{game:a})),"game.removePlayer"===i.eventName&&(a.updatePlayers(i.game.players),r.trigger("ui.1.game.players.changed",{game:a})),"game.setHost"===i.eventName&&(a.setHost({player:i.game.host,supressEvent:!0}),r.trigger("ui.1.game.players.changed",{game:a})))}),gapi.hangout.onParticipantsDisabled.add(function(e){console.log("disabled");var t,r,n,i,o;for(t=0,r=e.disabledParticipants.length;r>t;t++)for(i=e.disabledParticipants[t],n=a.players.length-1;n>=0;n--)o=a.players[n],i.id===o.id&&a.removePlayer({player:o})}),r.on("game.addPlayer",function(e){i.game.players=a.players,i.eventName="game.addPlayer",u()}),r.on("game.removePlayer",function(e){i.game.players=a.players,i.eventName="game.removePlayer",u()}),r.on("game.setHost",function(e){o.id===a.host.id&&gapi.hangout.layout.displayNotice("You have just been made the game host."),i.game.host=a.host,i.eventName="game.setHost",u()}),r.on("game.startStage",function(e){i.game.stage=a.stage,i.eventName="game.startStage",u()}),r.on("ui.1.button.join.click",function(){a.addPlayer({player:{type:"human",id:o.id,name:o.person.displayName,image:o.person.image.url}})})})}),define("main",function(){});