define("app",[],function(){var e,t=function(e){var t,r={};for(t in e)if(e.hasOwnProperty(t))try{r[t]=JSON.parse(e[t])}catch(a){}return r},r=function(e){var t,r={};for(t in e)if(e.hasOwnProperty(t))try{r[t]=JSON.stringify(e[t])}catch(a){}return r},a={LOBBY:1,LOADING:2,PLAY:3,DETERMINE_WINNER:4,CONGRATULATIONS:5};return e=angular.module("app",[]),e.run(["$rootScope",function(e){e.me=gapi.hangout.getLocalParticipant(),e.state=t(gapi.hangout.data.getState())||{},e.state.game||(e.state.game={}),e.state.game.currentStage||(e.state.game.currentStage=a.LOBBY),e.state.players||(e.state.players=[]),gapi.hangout.data.onStateChanged.add(function(r){var a,n,i,o;a=t(r.state);for(n in a)i=a[n],o=r.metadata[n];e.state=a,window.state=a,e.$apply()}),e.$watch("state",function(t,a,n){gapi.hangout.data.submitDelta(r(e.state)),window.state=e.state},!0),e.computers=0,e.addPlayer=function(t){var r,a;if(a=e.state.players,t.player&&t.player.id&&a.length<4&&!e.findPlayerById(t.player.id)){if(r={},!t.player.type)throw new Error("config.player.type was not provided");if(r.type=t.player.type,"human"===r.type){if(!t.player.id)throw new Error("config.player.id was not provided");if(r.id=t.player.id,!t.player.name)throw new Error("config.player.name was not provided");r.name=t.player.name,t.player.image&&(r.image=t.player.image)}else{if("computer"!==r.type)throw new Error('config.player.type is not a supported type (either "human", or "computer")');r.id="computer-"+Math.floor(1e4*Math.random()),r.name="Computer "+e.computers+1}return a.push(r),e.state.host||"human"!==r.type||(e.state.host=r),!0}return!1},e.findPlayerById=function(t){var r,a,n,i;for(i=e.state.players,r=0,a=i.length;a>r;r++)if(n=i[r],n.id===t)return n;return null},e.removePlayer=function(t){var r,a,n;if(n=e.state.players,!t.player)return!1;for(r=n.length-1;r>=0;r--)if(n[r]===t.player)return a=n.splice(r,1),!0;return!1},gapi.hangout.onParticipantsDisabled.add(function(t){console.log("Disabled: "+t);var r,a,n,i,o,s,p=!1,l=!1;if(s=e.state.players,e.state.host)for(r=0,a=t.disabledParticipants.length;a>r;r++)if(i=t.disabledParticipants[r],i.person.id===e.state.host.id){p=!0;break}if(p)for(r=0,a=s.length;a>r;r++)if(o=s[r],e.me.person.id===o.id&&"human"===o.type&&e.state.host.id!==o.id){e.state.host=o;break}if(e.state.host&&e.state.host.id===e.me.person.id&&(l=!0),l)for(console.log("I am handling the removal of this user"),r=0,a=t.disabledParticipants.length;a>r;r++)for(i=t.disabledParticipants[r],n=s.length-1;n>=0;n--)if(o=s[n],i.person.id===o.id){e.removePlayer({player:o});break}e.$apply()}),e.join=function(){e.addPlayer({player:{type:"human",id:e.me.person.id,name:e.me.person.displayName,image:e.me.person.image.url}})}}]),e}),define("events",[],function(){var e={},t={};return{on:function(r,a,n){if(t[r]){if(!n)return;try{a(t[r])}catch(i){console.error(i)}}e[r]||(e[r]=[]),e[r].push(a)},off:function(t,r){var a;if(e[t]&&e[t].length)for(a=e[t].length-1;a>=0;a--)e[t][a]===r&&e[t][a].splice(a,1)},trigger:function(r,a){var n,i,o;if(t[r]=a,e[r]&&e[r].length)for(n=0,i=e[r].length;i>n;n++)if(o=e[r][n])try{o(a)}catch(s){console.error(s)}return!0}}}),define("player",["events"],function(){var e=function(e){var t=this;if(!e.type)throw new Error("config.type was not provided");if(t.type=e.type,"human"===t.type){if(!e.id)throw new Error("config.id was not provided");if(t.id=e.id,!e.name)throw new Error("config.name was not provided");t.name=e.name,e.image&&(t.image=e.image)}else if("computer"!==t.type)throw new Error('config.type is not a supported type (either "human", or "computer")')},t=e.prototype;return t.takeTurn=function(){},e}),define("game",["player","events"],function(e,t){var r;return r={initialize:function(e){var t=this;return e.game.host&&(t.host=e.game.host),e.game.players&&(t.players=e.game.players),e.game.currentStage&&(t.currentStage=e.game.currentStage),!0},players:[],addPlayer:function(r){var a,n=this;return r.player&&r.player.id&&n.players.length<4&&!n.findPlayerById(r.player.id)?(a=new e(r.player),n.players.push(a),n.host||n.setHost({player:a}),r.supressEvent||t.trigger("game.addPlayer",{game:n}),!0):!1},updatePlayers:function(e){var t,r,a,n,i,o,s,p=this;for(t=0,r=e.length;r>t;t++){for(s=!1,i=e[t],a=0,n=p.players.length;n>a;a++)o=p.players[a],i.id===o.id&&(s=!0);s||p.addPlayer({player:i,supressEvent:!0})}for(a=0,n=p.players.length;n>a;a++){for(s=!1,o=p.players[a],t=0,r=e.length;r>t;t++)i=e[t],i.id===o.id&&(s=!0);s||p.removePlayer({player:i,supressEvent:!0})}},removePlayer:function(e){var a,n,i=this;if(!e.player)return!1;for(e.player.id===i.host.id&&i.players.length>0&&i.setHost({player:i.players[0]}),n=i.players.length-1;n>=0;n--)if(i.players[n]===e.player)return a=i.players.splice(n,1),e.supressEvent||t.trigger("game.removePlayer",{game:r}),!0;return!1},findPlayerById:function(e){var t,r,a,n=this;for(t=0,r=n.players.length;r>t;t++)if(a=n.players[t],a.id===e)return a;return null},host:null,setHost:function(e){var r=this;return"human"===e.player.type?(r.host=e.player,e.supressEvent||t.trigger("game.setHost",{game:r}),!0):!1},STAGES:{LOBBY:1,LOADING:2,PLAY:3,DETERMINE_WINNER:4,CONGRATULATIONS:5},currentStage:0,startStage:function(e){var r=this;r.currentStage=e,r.currentStage===r.STAGES.LOBBY||r.currentStage===r.STAGES.LOADING,t.trigger("game.startStage",{game:r})},start:function(e){var t=this;e.currentStage===t.STAGES.LOBBY||e.currentStage===t.STAGES.LOADING}}}),define("ui",["events"],function(e){var t=document,r=t.getElementById("buttonJoin");return r.addEventListener("click",function(){}),e.on("ui.1.game.players.changed",function(e){}),{}}),define("controllers/game",["app","player","events"],function(e,t,r){e.controller("GameController",["$rootScope",function(e){}])}),require(["app","game","player","events","ui","controllers/game"],function(e,t,r,a,n){var i=new Promise(function(e,t){gapi.hangout.onApiReady.add(function(t){t.isApiReady&&e()})});i.then(function(){angular.bootstrap(document,["app"])})}),define("main",function(){});