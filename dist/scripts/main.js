define("app",[],function(){var e,t=function(e){var t,a={};for(t in e)if(e.hasOwnProperty(t))try{a[t]=JSON.parse(e[t])}catch(r){}return a},a=function(e){var t,a={};for(t in e)if(e.hasOwnProperty(t))try{a[t]=JSON.stringify(e[t])}catch(r){}return a},r={LOBBY:1,CHOOSE_COLOR:2,PLAY:3,DETERMINE_WINNER:4,CONGRATULATIONS:5};return e=angular.module("app",[]),e.run(["$rootScope",function(e){e.me=gapi.hangout.getLocalParticipant(),e.state=t(gapi.hangout.data.getState())||{},e.state.game||(e.state.game={}),e.state.game.currentStage||(e.state.game.currentStage=r.LOBBY),e.state.players||(e.state.players=[]),e.state.colors||(e.state.colors={}),gapi.hangout.data.onStateChanged.add(function(a){var r,n,o,i;r=t(a.state);for(n in r)o=r[n],i=a.metadata[n];e.state=r,window.state=r,e.$apply()}),e.$watch("state",function(t,r,n){gapi.hangout.data.submitDelta(a(e.state)),window.state=e.state},!0),e.computers=0,e.addPlayer=function(t){var a,r;if(r=e.state.players,t.player&&t.player.id&&r.length<4&&!e.findPlayerById(t.player.id)){if(a={},!t.player.type)throw new Error("config.player.type was not provided");if(a.type=t.player.type,"human"===a.type){if(!t.player.id)throw new Error("config.player.id was not provided");if(a.id=t.player.id,!t.player.name)throw new Error("config.player.name was not provided");a.name=t.player.name,t.player.image&&(a.image=t.player.image)}else{if("computer"!==a.type)throw new Error('config.player.type is not a supported type (either "human", or "computer")');a.id="computer-"+Math.floor(1e4*Math.random()),a.name="Computer "+e.computers+1}return r.push(a),e.state.host||"human"!==a.type||(e.state.host=a),!0}return!1},e.findPlayerById=function(t){var a,r,n,o;for(o=e.state.players,a=0,r=o.length;r>a;a++)if(n=o[a],n.id===t)return n;return null},e.removePlayer=function(t){var a,r,n;if(n=e.state.players,!t.player)return!1;for(a=n.length-1;a>=0;a--)if(n[a]===t.player)return r=n.splice(a,1),!0;return!1},e.showLeaveModal=!1,e.leave=function(){var t,a,r,n,o=!1;if(n=e.state.players,e.state.host&&e.state.host.id===e.me.person.id&&(o=!0),o)for(e.state.host=null,t=0,a=n.length;a>t;t++)if(r=n[t],e.me.person.id!==r.id&&"human"===r.type){e.state.host=r;break}e.removePlayer({player:e.findPlayerById(e.me.person.id)})},gapi.hangout.onParticipantsDisabled.add(function(t){var a,r,n,o,i,s,p=!1,l=!1;if(s=e.state.players,e.state.host)for(a=0,r=t.disabledParticipants.length;r>a;a++)if(o=t.disabledParticipants[a],o.person.id===e.state.host.id){p=!0;break}if(p)for(a=0,r=s.length;r>a;a++)if(i=s[a],e.me.person.id===i.id&&"human"===i.type&&e.state.host.id!==i.id){e.state.host=i;break}if(e.state.host&&e.state.host.id===e.me.person.id&&(l=!0),l)for(a=0,r=t.disabledParticipants.length;r>a;a++)for(o=t.disabledParticipants[a],n=s.length-1;n>=0;n--)if(i=s[n],o.person.id===i.id){e.removePlayer({player:i});break}e.$apply()}),e.join=function(){e.addPlayer({player:{type:"human",id:e.me.person.id,name:e.me.person.displayName,image:e.me.person.image.url}})},e.start=function(){e.state.game.currentStage=r.CHOOSE_COLOR},e.chooseColor=function(t){e.remainingColors()&&!e.state.colors[t]&&(e.state.colors[t]=e.me.person.id)},e.remainingColors=function(){var t,a,r,n,o;r=e.state.colors,n=e.state.players,2===n.length?o=2:(3===n.length||4===n.length)&&(o=1);for(a in r)t=r[a],e.me.person.id===t&&o--;return o},e.getMyColors=function(t){var a,r,n,o=[],i={blue:"Blue",red:"Red",green:"Green",yellow:"Yellow"};n=e.state.colors;for(r in n)a=n[r],e.me.person.id===a&&(t&&i[r]?o.push(i[r]):o.push(r));return o},e.displayColors=function(){var t="",a=e.getMyColors(!0);return a[0]&&(t=a[0],a[1]&&(t+=" and "+a[1])),t}}]),e}),define("events",[],function(){var e={},t={};return{on:function(a,r,n){if(t[a]){if(!n)return;try{r(t[a])}catch(o){console.error(o)}}e[a]||(e[a]=[]),e[a].push(r)},off:function(t,a){var r;if(e[t]&&e[t].length)for(r=e[t].length-1;r>=0;r--)e[t][r]===a&&e[t][r].splice(r,1)},trigger:function(a,r){var n,o,i;if(t[a]=r,e[a]&&e[a].length)for(n=0,o=e[a].length;o>n;n++)if(i=e[a][n])try{i(r)}catch(s){console.error(s)}return!0}}}),require(["app","events"],function(e,t){var a=new Promise(function(e,t){gapi.hangout.onApiReady.add(function(t){t.isApiReady&&e()})});a.then(function(){angular.bootstrap(document,["app"])})}),define("main",function(){});